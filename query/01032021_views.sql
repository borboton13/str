/*
SQLyog Ultimate v12.09 (64 bit)
MySQL - 5.7.23-23 : Database - dimesatn_stcb
*********************************************************************
*/

/*View structure for view formulario_mtto */


CREATE VIEW `formulario_mtto` AS select `f`.`idformulario` AS `idformulario`,`p`.`id` AS `id`,`f`.`codigo` AS `codigo`,`f`.`nombre` AS `nombre`,`p`.`titulo` AS `titulo`,`p`.`idevento` AS `idevento` from (`formulario` `f` join `formulario_p001` `p` on((`f`.`idformulario` = `p`.`idformulario`))) union all select `f`.`idformulario` AS `idformulario`,`p`.`id` AS `id`,`f`.`codigo` AS `codigo`,`f`.`nombre` AS `nombre`,`p`.`titulo` AS `titulo`,`p`.`idevento` AS `idevento` from (`formulario` `f` join `formulario_p002` `p` on((`f`.`idformulario` = `p`.`idformulario`))) union all select `f`.`idformulario` AS `idformulario`,`p`.`id` AS `id`,`f`.`codigo` AS `codigo`,`f`.`nombre` AS `nombre`,`p`.`titulo` AS `titulo`,`p`.`idevento` AS `idevento` from (`formulario` `f` join `formulario_p003` `p` on((`f`.`idformulario` = `p`.`idformulario`))) union all select `f`.`idformulario` AS `idformulario`,`p`.`id` AS `id`,`f`.`codigo` AS `codigo`,`f`.`nombre` AS `nombre`,`p`.`titulo` AS `titulo`,`p`.`idevento` AS `idevento` from (`formulario` `f` join `formulario_p004` `p` on((`f`.`idformulario` = `p`.`idformulario`))) union all select `f`.`idformulario` AS `idformulario`,`p`.`id` AS `id`,`f`.`codigo` AS `codigo`,`f`.`nombre` AS `nombre`,`p`.`titulo` AS `titulo`,`p`.`idevento` AS `idevento` from (`formulario` `f` join `formulario_p005` `p` on((`f`.`idformulario` = `p`.`idformulario`))) union all select `f`.`idformulario` AS `idformulario`,`p`.`id` AS `id`,`f`.`codigo` AS `codigo`,`f`.`nombre` AS `nombre`,`p`.`titulo` AS `titulo`,`p`.`idevento` AS `idevento` from (`formulario` `f` join `formulario_p006` `p` on((`f`.`idformulario` = `p`.`idformulario`))) union all select `f`.`idformulario` AS `idformulario`,`p`.`id` AS `id`,`f`.`codigo` AS `codigo`,`f`.`nombre` AS `nombre`,`p`.`titulo` AS `titulo`,`p`.`idevento` AS `idevento` from (`formulario` `f` join `formulario_p007` `p` on((`f`.`idformulario` = `p`.`idformulario`))) union all select `f`.`idformulario` AS `idformulario`,`p`.`id` AS `id`,`f`.`codigo` AS `codigo`,`f`.`nombre` AS `nombre`,`p`.`titulo` AS `titulo`,`p`.`idevento` AS `idevento` from (`formulario` `f` join `formulario_p008` `p` on((`f`.`idformulario` = `p`.`idformulario`))) union all select `f`.`idformulario` AS `idformulario`,`p`.`id` AS `id`,`f`.`codigo` AS `codigo`,`f`.`nombre` AS `nombre`,`p`.`titulo` AS `titulo`,`p`.`idevento` AS `idevento` from (`formulario` `f` join `formulario_p009` `p` on((`f`.`idformulario` = `p`.`idformulario`))) union all select `f`.`idformulario` AS `idformulario`,`p`.`id` AS `id`,`f`.`codigo` AS `codigo`,`f`.`nombre` AS `nombre`,`p`.`titulo` AS `titulo`,`p`.`idevento` AS `idevento` from (`formulario` `f` join `formulario_p010` `p` on((`f`.`idformulario` = `p`.`idformulario`))) union all select `f`.`idformulario` AS `idformulario`,`p`.`id` AS `id`,`f`.`codigo` AS `codigo`,`f`.`nombre` AS `nombre`,`p`.`titulo` AS `titulo`,`p`.`idevento` AS `idevento` from (`formulario` `f` join `formulario_p011` `p` on((`f`.`idformulario` = `p`.`idformulario`))) union all select `f`.`idformulario` AS `idformulario`,`p`.`id` AS `id`,`f`.`codigo` AS `codigo`,`f`.`nombre` AS `nombre`,`p`.`titulo` AS `titulo`,`p`.`idevento` AS `idevento` from (`formulario` `f` join `formulario_p012` `p` on((`f`.`idformulario` = `p`.`idformulario`))) union all select `f`.`idformulario` AS `idformulario`,`p`.`id` AS `id`,`f`.`codigo` AS `codigo`,`f`.`nombre` AS `nombre`,`p`.`titulo` AS `titulo`,`p`.`idevento` AS `idevento` from (`formulario` `f` join `formulario_p013` `p` on((`f`.`idformulario` = `p`.`idformulario`))) union all select `f`.`idformulario` AS `idformulario`,`p`.`id` AS `id`,`f`.`codigo` AS `codigo`,`f`.`nombre` AS `nombre`,`p`.`titulo` AS `titulo`,`p`.`idevento` AS `idevento` from (`formulario` `f` join `formulario_p014` `p` on((`f`.`idformulario` = `p`.`idformulario`))) union all select `f`.`idformulario` AS `idformulario`,`p`.`id` AS `id`,`f`.`codigo` AS `codigo`,`f`.`nombre` AS `nombre`,`p`.`titulo` AS `titulo`,`p`.`idevento` AS `idevento` from (`formulario` `f` join `formulario_p015` `p` on((`f`.`idformulario` = `p`.`idformulario`))) union all select `f`.`idformulario` AS `idformulario`,`p`.`id` AS `id`,`f`.`codigo` AS `codigo`,`f`.`nombre` AS `nombre`,`p`.`titulo` AS `titulo`,`p`.`idevento` AS `idevento` from (`formulario` `f` join `formulario_p016` `p` on((`f`.`idformulario` = `p`.`idformulario`))) union all select `f`.`idformulario` AS `idformulario`,`p`.`id` AS `id`,`f`.`codigo` AS `codigo`,`f`.`nombre` AS `nombre`,`p`.`titulo` AS `titulo`,`p`.`idevento` AS `idevento` from (`formulario` `f` join `formulario_p017` `p` on((`f`.`idformulario` = `p`.`idformulario`))) union all select `f`.`idformulario` AS `idformulario`,`p`.`id` AS `id`,`f`.`codigo` AS `codigo`,`f`.`nombre` AS `nombre`,`p`.`titulo` AS `titulo`,`p`.`idevento` AS `idevento` from (`formulario` `f` join `formulario_p018` `p` on((`f`.`idformulario` = `p`.`idformulario`)));

/*View structure for view v_clientes */

CREATE VIEW `v_clientes` AS select `c`.`id` AS `id_cliente`,`c`.`razon_social` AS `razon_social`,`c`.`caracteristicas` AS `caracteristicas`,`c`.`nivel_cliente` AS `nivel_cliente`,`c`.`tcliente` AS `tcliente`,`c`.`area` AS `area`,`u`.`id` AS `id_usuario`,concat(`u`.`nombre`,_latin1' ',`u`.`ap_pat`) AS `creador`,`u`.`cuenta` AS `cuenta`,count(`ct`.`id_cliente`) AS `nro_contactos`,`c`.`activo` AS `activo` from ((`clientes` `c` left join `contactos` `ct` on((`c`.`id` = `ct`.`id_cliente`))) join `usuarios` `u` on((`c`.`creador` = `u`.`id`))) group by `c`.`id`;

/*View structure for view v_correlativo */

CREATE VIEW `v_correlativo` AS (select `a`.`id_st_proyecto` AS `id_st_proyecto`,_utf8'f001' AS `form`,`a`.`id_st_cronograma_informes_f001` AS `nro`,`a`.`p1` AS `p1`,`a`.`hora_salida` AS `hora_salida`,`b`.`ubicacion` AS `ubicacion`,`b`.`departamento` AS `departamento`,`b`.`producto` AS `producto`,`a`.`detalles` AS `caracteristicas`,`a`.`funcionario` AS `funcionario`,concat(`c`.`nombre`,_latin1' ',`c`.`ap_pat`) AS `personal`,`a`.`revision` AS `revision`,`a`.`condicion_final` AS `condicion_final`,`a`.`postm_condicion_final` AS `postm_condicion_final`,`a`.`pasos` AS `pasos`,`a`.`id_usuario` AS `id_usuario`,`a`.`id_item` AS `id_item`,`a`.`revision_ext` AS `revision_ext`,`a`.`nro_ticket` AS `nro_ticket`,`b`.`idestacion` AS `idestacion` from ((`st_cronograma_informes_f001` `a` join `st_trabajos` `b` on((`a`.`id_item` = `b`.`id_item`))) join `usuarios` `c` on((`a`.`id_usuario` = `c`.`id`)))) union (select `a`.`id_st_proyecto` AS `id_st_proyecto`,_utf8'f002' AS `form`,`a`.`id_st_cronograma_informes_f002` AS `nro`,`a`.`p1` AS `p1`,`a`.`hora_salida` AS `hora_salida`,`b`.`ubicacion` AS `ubicacion`,`b`.`departamento` AS `departamento`,`b`.`producto` AS `producto`,`a`.`detalles` AS `caracteristicas`,`a`.`funcionario` AS `funcionario`,concat(`c`.`nombre`,_latin1' ',`c`.`ap_pat`) AS `personal`,`a`.`revision` AS `revision`,`a`.`condicion_final` AS `condicion_final`,`a`.`postm_condicion_final` AS `postm_condicion_final`,`a`.`pasos` AS `pasos`,`a`.`id_usuario` AS `id_usuario`,`a`.`id_item` AS `id_item`,`a`.`revision_ext` AS `revision_ext`,`a`.`nro_ticket` AS `nro_ticket`,`b`.`idestacion` AS `idestacion` from ((`st_cronograma_informes_f002` `a` join `st_trabajos` `b` on((`a`.`id_item` = `b`.`id_item`))) join `usuarios` `c` on((`a`.`id_usuario` = `c`.`id`)))) union (select `a`.`id_st_proyecto` AS `id_st_proyecto`,_utf8'f003' AS `form`,`a`.`id_st_cronograma_informes_f003` AS `nro`,`a`.`p1` AS `p1`,`a`.`hora_salida` AS `hora_salida`,`b`.`ubicacion` AS `ubicacion`,`b`.`departamento` AS `departamento`,`b`.`producto` AS `producto`,`a`.`detalles` AS `caracteristicas`,`a`.`funcionario` AS `funcionario`,concat(`c`.`nombre`,_latin1' ',`c`.`ap_pat`) AS `personal`,`a`.`revision` AS `revision`,`a`.`condicion_final` AS `condicion_final`,`a`.`postm_condicion_final` AS `postm_condicion_final`,`a`.`pasos` AS `pasos`,`a`.`id_usuario` AS `id_usuario`,`a`.`id_item` AS `id_item`,`a`.`revision_ext` AS `revision_ext`,`a`.`nro_ticket` AS `nro_ticket`,`b`.`idestacion` AS `idestacion` from ((`st_cronograma_informes_f003` `a` join `st_trabajos` `b` on((`a`.`id_item` = `b`.`id_item`))) join `usuarios` `c` on((`a`.`id_usuario` = `c`.`id`))));

/*View structure for view v_gfm */

CREATE VIEW `v_gfm` AS (select `t`.`id_st_ticket` AS `id`,`t`.`ticket` AS `ticket`,`t`.`idnodo` AS `idnodo`,`t`.`estacion` AS `estacion`,`t`.`fecha_inicio_rif` AS `fecha_inicio`,`t`.`hora_inicio_rif` AS `hora_inicio`,`t`.`fecha_fin_rif` AS `fecha_fin`,`t`.`hora_fin_rif` AS `hora_fin`,timediff(concat(`t`.`fecha_fin_rif`,' ',`t`.`hora_fin_rif`),concat(`t`.`fecha_inicio_rif`,' ',`t`.`hora_inicio_rif`)) AS `duracion`,`t`.`tipo` AS `tipo`,`t`.`problema` AS `problema`,`t`.`fecha_not` AS `fecha_not`,`t`.`hora_not` AS `hora_not`,`t`.`nombre_estacion` AS `nombre_estacion`,`t`.`ticket_tmp` AS `n_ticket`,`g`.`afeccion` AS `g_afeccion`,`g`.`motivo` AS `g_motivo` from (`st_ticket` `t` join `GFM` `g`) where ((`t`.`ticket_tmp` = `g`.`ticket_tmp`) and (`t`.`fecha_inicio_rif` between '2015-04-01' and '2015-06-30') and (`g`.`fecha_ini` between '2015-04-01' and '2015-06-30')));

/*View structure for view v_st_cronograma */

CREATE VIEW `v_st_cronograma` AS (select (case dayofweek(`tc`.`fecha`) when 1 then _utf8'DOM' when 2 then _utf8'LUN' when 3 then _utf8'MAR' when 4 then _utf8'MIE' when 5 then _utf8'JUE' when 6 then _utf8'VIE' when 7 then _utf8'SAB' end) AS `dia`,`tc`.`fecha` AS `fecha`,`tc`.`hora_programada` AS `hora_programada`,concat(`u`.`nombre`,_latin1' ',`u`.`ap_pat`) AS `responsable`,`tc`.`condicion_final` AS `condicion_final`,`t`.`departamento` AS `departamento`,`c`.`razon_social` AS `razon_social`,`t`.`producto` AS `producto`,`t`.`marca` AS `marca`,`t`.`caracteristicas` AS `caracteristicas`,`t`.`ubicacion` AS `ubicacion`,`tc`.`id_item` AS `id_item`,`tc`.`id_st_proyecto` AS `id_st_proyecto`,`tc`.`id_usuario` AS `id_usuario`,`tc`.`id_cliente` AS `id_cliente`,`tc`.`postm_condicion_final` AS `postm_condicion_final` from (((`st_cronograma_informes_f001` `tc` join `st_trabajos` `t`) join `usuarios` `u`) join `clientes` `c`) where ((`tc`.`id_usuario` = `u`.`id`) and (`tc`.`id_item` = `t`.`id_item`) and (`tc`.`id_cliente` = `c`.`id`))) union (select (case dayofweek(`tc`.`fecha`) when 1 then _utf8'DOM' when 2 then _utf8'LUN' when 3 then _utf8'MAR' when 4 then _utf8'MIE' when 5 then _utf8'JUE' when 6 then _utf8'VIE' when 7 then _utf8'SAB' end) AS `dia`,`tc`.`fecha` AS `fecha`,`tc`.`hora_programada` AS `hora_programada`,concat(`u`.`nombre`,_latin1' ',`u`.`ap_pat`) AS `responsable`,`tc`.`condicion_final` AS `condicion_final`,`t`.`departamento` AS `departamento`,`c`.`razon_social` AS `razon_social`,`t`.`producto` AS `producto`,`t`.`marca` AS `marca`,`t`.`caracteristicas` AS `caracteristicas`,`t`.`ubicacion` AS `ubicacion`,`tc`.`id_item` AS `id_item`,`tc`.`id_st_proyecto` AS `id_st_proyecto`,`tc`.`id_usuario` AS `id_usuario`,`tc`.`id_cliente` AS `id_cliente`,`tc`.`postm_condicion_final` AS `postm_condicion_final` from (((`st_cronograma_informes_f002` `tc` join `st_trabajos` `t`) join `usuarios` `u`) join `clientes` `c`) where ((`tc`.`id_usuario` = `u`.`id`) and (`tc`.`id_item` = `t`.`id_item`) and (`tc`.`id_cliente` = `c`.`id`)));
